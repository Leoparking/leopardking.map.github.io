<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft 时间换算器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input[type="date"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #218838;
        }
        .result {
            margin-top: 20px;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Minecraft 时间换算器</h1>
        <h4>小贴士：将MC日期转为现实日期前请先清除现实日期栏</h4>
        <label for="realDate">现实日期：</label>
        <input type="date" id="realDate" value="2009-05-16">
        <label for="minecraftDate">Minecraft 日期：</label>
        <input type="date" id="minecraftDate">
        <button onclick="calculate()">换算</button>
        <div class="result" id="result"></div>
        <br>
        <br>
        <br>
        <br>
        <br>
        <p>计算公式：现实时间流速是MC的72分之一，为了简化逻辑，每年按365.5天计算</p>
        <p>现实→MC：将现实日期转为天数，然后乘上72倍，再转为年月日格式</p>
        <p>MC→现实：将MC日期转为天数，然后除以72倍，再转为年月日格式</p>
        <h3>MC世界元年：2009-5-16</h3>
    </div>

    <script>
        const TIME_RATIO = 72;
        const START_DATE = new Date("2009-05-16");

        // 手动解析 Minecraft 日期（解决大年份问题）
        function parseMinecraftDate(dateStr) {
            const [year, month, day] = dateStr.split("-").map(Number);
            return { year, month: month - 1, day }; // 月份转为 0-11
        }

        // Minecraft 日期转天数（修正计算）
        function minecraftDateToDays(dateStr) {
            const { year, month, day } = parseMinecraftDate(dateStr);
            const daysPerYear = 365.5;
            const daysPerMonth = daysPerYear / 12;
            return (year * daysPerYear) + (month * daysPerMonth) + day;
        }

        // 天数转 Minecraft 日期（修正月份计算）
        function daysToMinecraftDate(totalDays) {
            const daysPerYear = 365.5;
            const daysPerMonth = daysPerYear / 12;

            let years = Math.floor(totalDays / daysPerYear);
            let remainingDays = totalDays % daysPerYear;

            let months = Math.floor(remainingDays / daysPerMonth);
            remainingDays = remainingDays % daysPerMonth;
            
            // 处理小数精度问题
            let days = Math.round(remainingDays * 100) / 100;

            // 确保月份从1开始
            months = months + 1; // 修正关键点：月份从1开始
            if (months >= 12) {
                years += 1;
                months -= 12;
            }

            return `${years} 年 ${Math.floor(months)} 月 ${Math.floor(days)} 日`;
        }

        function calculate() {
            const realDateInput = document.getElementById("realDate").value;
            const minecraftDateInput = document.getElementById("minecraftDate").value;

            let resultText = "";

            try {
                if (realDateInput) {
                    // 现实 -> Minecraft
                    const realDate = new Date(realDateInput);
                    const timeDiff = realDate - START_DATE;
                    const daysDiff = timeDiff / 86400000;
                    const minecraftDays = daysDiff * TIME_RATIO;
                    resultText = `现实 ${realDateInput} → Minecraft ${daysToMinecraftDate(minecraftDays)}`;
                } else if (minecraftDateInput) {
                    // Minecraft -> 现实
                    const minecraftDays = minecraftDateToDays(minecraftDateInput);
                    const realDays = minecraftDays / TIME_RATIO;
                    const realDate = new Date(START_DATE.getTime() + realDays * 86400000);
                    resultText = `Minecraft ${minecraftDateInput} → 现实 ${realDate.toISOString().split("T")[0]}`;
                }
            } catch (e) {
                resultText = "输入格式错误！正确格式：YYYY-MM-DD";
            }

            document.getElementById("result").innerHTML = resultText || "请输入有效日期";
        }
    </script>
</body>
</html>